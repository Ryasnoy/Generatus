#!/bin/bash

directory=$1
moduleName=$0

echo "âš¡ï¸Welcome to Generatus Â© Powered by Ryasnoy Olegâš¡ï¸"

DIR="$( cd "$( dirname "${BASH_SOURCE[0]}" )" && pwd )/Templates"

function generateTemplatesFiles () {
  echo "Enter module name ~>"
  read moduleName
# /Users/oleg/Documents/Generatus/
  echo "âœ…Templates createdâœ…"
  cd $directory && mkdir $moduleName && cd $moduleName
  cp -R $DIR/*.swift $directory/$moduleName
  for i in *.swift ; do
  mv $i `echo "$i"|awk -F'.' '{print "'$moduleName'"$1"."$2}'`
  sed -i '' 's/#mdlnm/'$moduleName'/g' *.swift
done

}

function enterDirectory () {
  echo "Enter directory path ~> "
  read directory
  if [[ -d "$directory" ]]; then
  generateTemplatesFiles
  else
    echo "â›”ï¸Invalid directoryâ›”ï¸"
    enterDirectory
  fi
}

function askAboutInteractor () {
  read -r -p "ðŸ“„ Do you want create Interactor(Use Case)ðŸ“„? [y/N] " response
case "$response" in
    [yY][eE][sS]|[yY])
        generateInteractorFile
        ;;
    *)
    echo "âš¡ï¸Thank you for using Generatusâš¡ï¸"  ;;
esac
}

function generateInteractorFile () {
  echo "Enter Interactor (Use Case) name ~>"
  read interactor
  touch $interactor"Interactor".swift
  echo "//
// âš¡ï¸Generated by Generatusâš¡ï¸
//
// $moduleName"Interactor".swift
//
// **************************
//  Powered by Ryasnoy Oleg
// **************************" >> $interactor"Interactor".swift
  echo "âœ…$interactor"Interactor".swift createdâœ…"
  askAboutInteractor
}

enterDirectory
askAboutInteractor

exit 0
